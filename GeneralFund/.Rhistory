#TO run this script, type this comamand in terminal
# rscript cle_budget_script.R
# OR
# highlight all the text and click the run button above.
#Import data by reading each excel page as a csv and saving it to a dataframe
df_01_council = read_csv('data_viz_cle/GeneralFund/01_CouncilandClerkofCouncil_pg82-83.csv')
df_02_mayor = read_csv('data_viz_cle/GeneralFund/02_OfficeofMayor_pg87-88.csv')
df_03_capitalprojects = read_csv('data_viz_cle/GeneralFund/03_OfficeofCapitalProjects_pg91-93.csv')
#Get the 2017 Values for the Salary section
#This part of the code is what gets specific rows and columns
# [1:10,1:2]  -> 1:10 means get first 10 rows
# [1:10,1:2]  -> 1:2 means get first 2 columns
GF_council_salary_2017 <- df_01_council[1:10,1:2]
GF_mayor_salary_2017 <- df_02_mayor[1:10,1:2]
GF_capitalprojects_salary_2017 <- df_03_capitalprojects[1:10,1:2]
#Merge all the offices into one dataframe
# This code is confusing code, so I'll explain it part by part
# Reduce(function(r_x,r_y) : Reduce recursively applies the function we give it. Here we are giving the merge function and saying that function takes 2 vars, x & y
# merge(x=r_x, y=r_y : Merge is a function that combines two datasets. Here we are telling it merge whatever r_x & r_y the reduce function is currently looping through
# These are parameters for the merge function that define how we want the merge function to work
# by= 1 : means merge on the first column of every dataframe
# all=true : means do an outerjoin (ie- keep all rows)
# suffix =   #suffix=c(names(r_x)[1], names(r_y)[1])) : renames the columns of the outputed table. maybe not needed
# list(...) : this is the 2nd param of the reduce function. This is the loop of dataframes we want to merge
f_salary_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=r_y, by=1, all=TRUE),
list(GF_council_salary_2017, GF_mayor_salary_2017, GF_capitalprojects_salary_2017))
#Rename first column
names(f_salary_2017)[1] <- '2017 - Salary'
names(f_salary_2017)[2] <- 'Council and Clerk of Council'
names(f_salary_2017)[3] <- 'Office of Mayor'
names(f_salary_2017)[4] <- 'Office of Capital Projects'
### REPEAT ABOVE CODE FOR BENEFITS SECTION ##
#Get the 2017 Values for the Budget section
#This part of the code is what gets specific rows and columns
# [12:23,1:2]  -> 11:23 means get rows 11 to 23
# [1:10,1:2]  -> 1:2 means get first 2 columns
GF_council_benefits_2017 <- df_01_council[12:23,1:2]
GF_mayor_benefits_2017 <- df_02_mayor[12:23,1:2]
GF_capitalprojects_benefits_2017 <- df_03_capitalprojects[12:23,1:2]
#Merge all the offices into one dataframe
f_benefits_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=r_y, by=1, all=TRUE),
list(GF_council_benefits_2017, GF_mayor_benefits_2017, GF_capitalprojects_benefits_2017))
#Rename columns
names(f_benefits_2017)[1] <- '2017 - Benefits'
names(f_benefits_2017)[2] <- 'Council and Clerk of Council'
names(f_benefits_2017)[3] <- 'Office of Mayor'
names(f_benefits_2017)[4] <- 'Office of Capital Projects'
View(f_benefits_2017)
View(f_benefits_2017)
View(f_salary_2017)
library("tidyverse")
library("data.table")
library("tidyverse")
file_names <- list.files(pattern="*.csv")
library("tidyverse")
library("data.table")
library("dplyr")
library("shiny")
library("treemap")
setwd("./data_viz_cle/3/GeneralFund/")
getwd()
file_names <- list.files(pattern="*.csv")
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
library("tidyverse")
library("data.table")
library("dplyr")
library("shiny")
library("treemap")
r version
R--version
--version
version()
r.version()
R.Version()
updateR()
install.packages(c("data.table", "dplyr"))
library("tidyverse")
library("data.table")
library("dplyr")
library("shiny")
library("treemap")
library("tidyverse")
library("data.table")
library("dplyr")
install.packages("installr")
library(installr)
updateR()
library("tidyverse")
library("data.table")
library("dplyr")
update.packages(checkBuilt = TRUE)
library("tidyverse")
library("data.table")
library("dplyr")
file_names <- list.files(pattern="*.csv")
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
library("data.table")
library("dplyr")
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
library("tidyverse")
library("tidyverse")
library("data.table")
library("dplyr")
library("data.table")
library("dplyr")
install.packages("data.table")
install.packages("dplyr")
library("tidyverse")
library("data.table")
library("dplyr")
install.packages("backports")
library("tidyverse")
library("fs")
install.packages("fs")
library("tidyverse")
install.packages("stringi")
library("tidyverse")
library("data.table")
library("dplyr")
setwd("./data_viz_cle/3/GeneralFund/")
getwd()
file_names <- list.files(pattern="*.csv")
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
salary_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(2:12))
salary_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(2:12))
salary_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(2:12))
salary_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(2:12))
salary_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2017)
salary_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2018)
salary_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2019)
salary_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2020)
View(salary_2017)
benefits_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(14:26))
benefits_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(14:26))
benefits_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(14:26))
benefits_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(14:26))
benefits_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2017)
benefits_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2018)
benefits_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2019)
benefits_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2020)
View(benefits_2017)
View(benefits_2019)
View(benefits_2017)
View(benefits_2017)
View(df_list)
View(df_list[["Bldg.HousingDirector.sOffice_pg342.44"]])
View(df_list[["DivisionofAccounts_pg186"]])
View(df_list[["OtherAdministrative_pg362.63"]])
benefits_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(14:24))
benefits_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(14:24))
benefits_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(14:24))
benefits_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(14:24))
benefits_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2017)
benefits_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2018)
benefits_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2019)
benefits_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2020)
### BENEFITS ###
### OTHER TRAINING ###
#Other Training 25-36
training_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(25:36))
training_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(25:36))
training_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(25:36))
training_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(25:36))
training_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2017)
training_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2018)
training_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2019)
training_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2020)
View(training_2017)
View(df_list[["CouncilandClerkofCouncil_pg82.83"]])
View(df_list[["OtherAdministrative_pg362.63"]])
#Other Training 25-36
training_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(26:36))
training_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(26:36))
training_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(26:36))
training_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(26:36))
training_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2017)
training_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2018)
training_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2019)
training_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2020)
### OTHER TRAINING ###
source('~/data_viz_cle/3/GeneralFund/general_fund_script_3.R')
setwd("./data_viz_cle/3/GeneralFund/")
getwd()
file_names <- list.files(pattern="*.csv")
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
salary_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(3:14))
salary_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(3:14))
salary_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(3:14))
salary_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(3:14))
salary_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2017)
salary_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2018)
salary_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2019)
salary_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2020)
### SALARY ###
View(salary_2018)
View(df_list[["Bldg.HousingDirector.sOffice_pg342.44"]])
salary_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(2:13))
salary_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(2:13))
salary_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(2:13))
salary_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(2:13))
salary_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2017)
salary_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2018)
salary_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2019)
salary_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2020)
### SALARY ###
#Salaries 3-14
salary_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(2:13))
salary_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(2:13))
salary_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(2:13))
salary_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(2:13))
salary_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2017)
salary_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2018)
salary_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2019)
salary_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2020)
### SALARY ###
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
#Salaries 3-14
salary_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(2:13))
salary_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(2:13))
salary_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(2:13))
salary_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(2:13))
salary_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2017)
salary_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2018)
salary_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2019)
salary_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), salary_list_2020)
### SALARY ###
#Benefits 15-26
benefits_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(14:25))
benefits_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(14:25))
benefits_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(14:25))
benefits_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(14:25))
benefits_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2017)
benefits_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2018)
benefits_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2019)
benefits_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2020)
### BENEFITS ###
#Other Training 27-36
training_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(26:35))
training_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(26:35))
training_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(26:35))
training_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(26:35))
training_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2017)
training_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2018)
training_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2019)
training_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), training_list_2020)
### OTHER TRAINING ###
View(training_2017)
View(benefits_2017)
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
#Benefits 15-26
benefits_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(14:25))
benefits_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(14:25))
benefits_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(14:25))
benefits_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(14:25))
benefits_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2017)
benefits_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2018)
benefits_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2019)
benefits_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), benefits_list_2020)
### BENEFITS ###
View(training_2017)
#Contractual Services 37-50
contract_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(36:49))
contract_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(36:49))
contract_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(36:49))
contract_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(36:49))
contract_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2017)
contract_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2018)
contract_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2019)
contract_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2020)
### CONTRACTUAL SERVICES ###
View(contract_2017)
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
#Contractual Services 37-50
contract_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(36:49))
contract_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(36:49))
contract_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(36:49))
contract_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(36:49))
contract_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2017)
contract_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2018)
contract_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2019)
contract_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2020)
### CONTRACTUAL SERVICES ###
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
contract_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(36:49))
contract_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(36:49))
contract_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(36:49))
contract_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(36:49))
contract_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2017)
contract_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2018)
contract_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2019)
contract_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2020)
### CONTRACTUAL SERVICES ###
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
contract_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(36:49))
contract_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(36:49))
contract_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(36:49))
contract_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(36:49))
contract_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2017)
contract_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2018)
contract_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2019)
contract_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), contract_list_2020)
### CONTRACTUAL SERVICES ###
#Utilities 51-57
utilities_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(50:56))
utilities_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(50:56))
utilities_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(50:56))
utilities_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(50:56))
utilities_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), utilities_list_2017)
utilities_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), utilities_list_2018)
utilities_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), utilities_list_2019)
utilities_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), utilities_list_2020)
### UTILITIES ###
View(utilities_2017)
#Materials & Supplies - 58-74
materials_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(57:73))
materials_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(57:73))
materials_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(57:73))
materials_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(57:73))
materials_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), materials_list_2017)
materials_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), materials_list_2018)
materials_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), materials_list_2019)
materials_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), materials_list_2020)
### MATERIALS ###
View(materials_2017)
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
#Materials & Supplies - 58-74
materials_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(57:73))
materials_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(57:73))
materials_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(57:73))
materials_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(57:73))
materials_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), materials_list_2017)
materials_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), materials_list_2018)
materials_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), materials_list_2019)
materials_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), materials_list_2020)
### MATERIALS ###
#Maintenance - 75-84
maintenance_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(74:83))
maintenance_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(74:83))
maintenance_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(74:83))
maintenance_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(74:83))
maintenance_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), maintenance_list_2017)
maintenance_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), maintenance_list_2018)
maintenance_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), maintenance_list_2019)
maintenance_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), maintenance_list_2020)
### MAINTENANCE ###
View(maintenance_2017)
#Interdepart Service Charges- 85-98
interdepart_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(84:97))
interdepart_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(84:97))
interdepart_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(84:97))
interdepart_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(84:97))
interdepart_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2017)
interdepart_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2018)
interdepart_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2019)
interdepart_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2020)
### INTERDEPARTMENT ###
View(interdepart_2017)
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
#Interdepart Service Charges- 85-98
interdepart_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(84:97))
interdepart_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(84:97))
interdepart_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(84:97))
interdepart_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(84:97))
interdepart_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2017)
interdepart_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2018)
interdepart_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2019)
interdepart_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2020)
### INTERDEPARTMENT ###
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
#Interdepart Service Charges- 85-98
interdepart_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(84:97))
interdepart_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(84:97))
interdepart_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(84:97))
interdepart_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(84:97))
interdepart_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2017)
interdepart_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2018)
interdepart_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2019)
interdepart_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2020)
### INTERDEPARTMENT ###
View(interdepart_2017)
### REVENUE ###
#Revenue 100-113
revenue_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(99:112))
revenue_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(99:112))
revenue_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(99:112))
revenue_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(99:112))
revenue_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), revenue_list_2017)
revenue_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), revenue_list_2018)
revenue_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), revenue_list_2019)
revenue_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), revenue_list_2020)
### RENUVE ###
View(revenue_2017)
#Capital Outlay 115-129
c_outlay_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(114:128))
c_outlay_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(114:128))
c_outlay_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(114:128))
c_outlay_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(114:128))
c_outlay_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), c_outlay_list_2017)
c_outlay_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), c_outlay_list_2018)
c_outlay_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), c_outlay_list_2019)
c_outlay_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), c_outlay_list_2020)
### CAPITAL OUTLAY ###
View(c_outlay_2017)
#Claims Refunds Maintenance 130-140
claims_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(129:139))
claims_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(129:139))
claims_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(129:139))
claims_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(129:139))
claims_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2017)
claims_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2018)
claims_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2019)
claims_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2020)
### CLAIMS ###
View(claims_2017)
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
#Claims Refunds Maintenance 130-140
claims_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(129:139))
claims_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(129:139))
claims_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(129:139))
claims_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(129:139))
claims_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2017)
claims_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2018)
claims_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2019)
claims_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2020)
### CLAIMS ###
#Interfund Subsidies - 141
interfund_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(140:155))
interfund_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(140:155))
interfund_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(140:155))
interfund_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(140:155))
interfund_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interfund_list_2017)
interfund_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interfund_list_2018)
interfund_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interfund_list_2019)
interfund_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interfund_list_2020)
### INTERFUND ###
View(interdepart_2017)
df_list <- lapply(setNames(file_names, make.names(gsub("*.csv", "", file_names))),
read_csv)
#Interdepart Service Charges- 85-98
interdepart_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(84:97))
interdepart_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(84:97))
interdepart_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(84:97))
interdepart_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(84:97))
interdepart_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2017)
interdepart_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2018)
interdepart_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2019)
interdepart_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interdepart_list_2020)
### INTERDEPARTMENT ###
### REVENUE ###
#Revenue 100-113
revenue_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(99:112))
revenue_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(99:112))
revenue_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(99:112))
revenue_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(99:112))
revenue_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), revenue_list_2017)
revenue_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), revenue_list_2018)
revenue_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), revenue_list_2019)
revenue_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), revenue_list_2020)
### RENUVE ###
### CAPITAL OUTLAY ###
#Capital Outlay 115-129
c_outlay_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(114:128))
c_outlay_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(114:128))
c_outlay_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(114:128))
c_outlay_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(114:128))
c_outlay_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), c_outlay_list_2017)
c_outlay_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), c_outlay_list_2018)
c_outlay_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), c_outlay_list_2019)
c_outlay_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), c_outlay_list_2020)
### CAPITAL OUTLAY ###
### CLAIMS ###
#Claims Refunds Maintenance 130-140
claims_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(129:139))
claims_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(129:139))
claims_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(129:139))
claims_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(129:139))
claims_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2017)
claims_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2018)
claims_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2019)
claims_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), claims_list_2020)
### CLAIMS ###
### INTERFUND ###
#Interfund Subsidies - 141
interfund_list_2017 <- lapply(df_list, function(x) x %>% select(1:2) %>% slice(140:155))
interfund_list_2018 <- lapply(df_list, function(x) x %>% select(1,3) %>% slice(140:155))
interfund_list_2019 <- lapply(df_list, function(x) x %>% select(1,4) %>% slice(140:155))
interfund_list_2020 <- lapply(df_list, function(x) x %>% select(1,5) %>% slice(140:155))
interfund_2017 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interfund_list_2017)
interfund_2018 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interfund_list_2018)
interfund_2019 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interfund_list_2019)
interfund_2020 <- Reduce(function(r_x,r_y) merge(x=r_x, y=na.omit(r_y), by=1, all=TRUE, suffix=c(names(r_x)[0], names(r_y)[1])), interfund_list_2020)
### INTERFUND ###
View(benefits_2017)
View(revenue_2017)
View(benefits_2017)
View(c_outlay_2017)
View(claims_2017)
View(interfund_2017)
